//#define WINDOWS_UWP
using System;
using System.IO;
using DataLayer;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Options;
using OldDataLayer;
using FluentAssertions;
using System.Text.Json;
using Newtonsoft.Json.Linq;
using Newtonsoft.Json;
using static System.Net.Mime.MediaTypeNames;
using System.Text.RegularExpressions;

namespace DataTools
{
    public class DbTools
    {
        [SetUp]
        public void Setup()
        {
        }

        [Test]
        public void CreateOpen_Database()
        {
            // Configure the database connection
            //            using var dbContext = new YiDbContext(@"c:\Git\Yi\");
            using var dbContext = new YiDbContext();
            dbContext.Database.Migrate();
        }
        [Test]
        public void OpenOldDatabase()
        {
            // Configure the database connection
            using var dbContext = new OldYiDbContext(@"c:\Git\Yi\");
            dbContext.Database.OpenConnection();
            var tables = dbContext.GetTableNames();
            tables.Count.Should().BeGreaterThan(0);
            var records = dbContext.GuaExp.ToList();
            records.Count.Should().BeGreaterThan(0);
        }


        [Test]
        public void CreateData()
        {
            // Configure the database connection
            //            using var dbContext = new YiDbContext(@"c:\Git\Yi\");
            using var dbContext = new YiDbContext();
            if (!dbContext.Delete()) Assert.Fail("Delete unsuccessfull");

            dbContext.Database.Migrate();

            Language langEng = new Language { Name = "English" };
            dbContext.Languages.Add(langEng);
            Language langHun = new Language { Name = "Hungarian" };
            dbContext.Languages.Add(langHun);

            MainText text1 = new MainText { Language = langEng, Text = "Lorem ipsum dolor sit amet, consectetur adipiscing elit" };
            dbContext.Texts.Add(text1);
            MainText text2 = new MainText { Language = langEng, Text = "sed do eiusmod tempor incididunt ut labore et dolore magna aliqua" };
            dbContext.Texts.Add(text2);
            MainText text3 = new MainText { Language = langEng, Text = "Ut enim ad minim veniam, quis nostrud exercitation ullamco" };
            dbContext.Texts.Add(text3);

            var lt1 = new LineText { MainText = text1, Text = "Lorem ipsum dolor sit amet" };
            var lt2 = new LineText { MainText = text2, Text = "consectetur adipiscing elit" };
            var lt3 = new LineText { MainText = text3, Text = "sed do eiusmod tempor incididunt" };
            dbContext.LineTexts.Add(lt1);
            dbContext.LineTexts.Add(lt2);
            dbContext.LineTexts.Add(lt3);

            var h1 = new Hexagram { Value = 1, Name = "Hexagram 1" };
            dbContext.Hexagrams.Add(h1);
            var h2 = new Hexagram { Value = 2, Name = "Hexagram 2" };
            dbContext.Hexagrams.Add(h2);
            var h3 = new Hexagram { Value = 3, Name = "Hexagram 3" };
            dbContext.Hexagrams.Add(h3);

            var q1 = new Question { Text = "What is your favorite color?", BaseHexagram = h1 };
            var q2 = new Question { Text = "What is your favorite food?", BaseHexagram = h1, ChangedHexagram = h2 };
            var q3 = new Question { Text = "What is your favorite movie?" };
            dbContext.Questions.Add(q1);
            dbContext.Questions.Add(q2);
            dbContext.Questions.Add(q3);

            dbContext.SaveChanges();
        }

        [Test]
        public void ExportToJson()
        {
            using var dbContext = new YiDbContext();

            dbContext.Database.Migrate();
            dbContext.ExportToJson(@"c:\git\yi\export.json");
        }

        [Test]
        public void ExportOldToJson()
        {
            //using var dbContext = new OldYiDbContext();
            using var dbContext = new OldYiDbContext(@"c:\Git\Yi\");

            dbContext.Database.Migrate();
            dbContext.ExportToJson(@"c:\git\yi\exportOld.json");
        }


        [Test]
        public void ParseLinesHun()
        {
            string input = @"2. Kun-BEFOGADÓ\n(Képjel. Föld - és a „területnek”, a „térnek” a jele)\n\nHat Jin vonás (azaz két „Föld” kua, trigram) alkotja e jelet.\nA Kun a Föld, az Anya, a Földanya, a Természet.\nAz Ég a láthatatlan ideák helye. Itt még minden a „gondolom”, „akarom”, a „legyen!” állapotában van, az Idő negyedik dimenziójában - ahhoz, hogy mindez megvalósuljon, kell az anyaöl odaadása, az anyaméh türelmes formáló ereje, amelyben testté alakul a mag, formává a gondolat; kell hozzá a hűség ereje, az odaadás ereje, az alkalmazkodás ereje. Az Égihez kell a Földi!\n\nBárhová nézel a földön, a növényekben, fákban, hegyekben, sziklákban, kövekben, de még egy ma-rok földben is az Anya művét látod: ezt csinálta abból, amit az Égi Atya akart: megvalósította. Alak-ká, térré formálta.\n\nA jósjel ítélete éppoly „szerencsés”, mint az előzőé:\n„Befogadó (Kun): jüan, heng, li, csen - de mindezt egy kanca odaadó kitartásával éri el.”\nA ló a Föld szimbóluma.\nA csődör is!\nA „kanca” itt azért szerepel, mert ősi tapasztalat, hogy ha egy csődör megindul, az összes kanca kö-veti. És ami szintén lényeges: több terhet tud viselni, mint a csődör.\nA követés a jel lényege: „Ő informál, s én megteszem.” (Mint amikor vezetnek a táncban!)\nA Kun valóra váltja azt, amit a Csien akart.\nLétrehozza a bőséget, a szépséget; növel, táplál, megsokszoroz.\nHa elveszti alázatát, ha ő akar irányítani, a folyamat csődöt mond: A szépség eltorzul, az eredmé-nyek elvetélnek, bőség helyett rákos burjánzás indul.\nA Kun mérhetetlen ereje az odaadó követésben van.\nAbban, hogy a gondolatot valóra váltja.\nA karmester csak int - a hangot, a dallamot és magát a muzsikát a zenész hozza létre, azzal, hogy követi a néma akaratot.\nA Kun jósjele azt tanácsolja: ne menj a saját fejed után! Inkább az intuíciódra hallgass, mint az eszedre. Ne törj az élre! Ne akarj irányítani! Légy türelmes! Egyszerű. Szívós. Józan. Bízz az ihle-tedben!\n\nMinél odaadóbb vagy, annál eredményesebb. Kövesd a csillagodat.\nA teremtés nem a te dolgod - a létrehozás igen! A megvalósítás.\nFigyelj a kézzel fogható, „reális” folyamatokra! Vesd meg lábadat a földön!\n\nGondolatok\n\nAz „Örök női” a legmélyebb szimbólum.\nSajnos, ma nem értjük, mert a sötét korban a nemek méltósága és jellege reménytelenül összekevere-dett: nincsenek igazi nők, ahogy nincsenek igazi férfiak sem.\nIsten egy - de ha megnyilvánul: kettő.\nTeremtő és Befogadó. Valamennyien Teremtők-Befogadók vagyunk - nemünktől függetlenül. Ahogy ki- és belélegzünk, úgy van életünknek Teremtő és Befogadó fázisa is.\nKözösségi életünkben is hol az egyik, hol a másik szerepet játsszuk, függetlenül attól, hogy apák va-gyunk vagy anyák.\nHa imádkozunk, valamennyien Befogadók vagyunk - Jézus is az volt: mindenben követte az Atya akaratát.\nTanítványainak azonban Teremtője volt, mint minden igazi Mester.\n„Hím” és „női” szerepek és létfázisok folyamatosan váltakoznak.\nEnnek a jósjelnek a lényege, hogy valami olyasmit kell követnem, amiről nem tudom pontosan, hogy micsoda.\nNem értem.\nNem tudatosult még bennem.\nOda kell adnom magamat valaminek - nem azért, mert ismerem, hanem azért, mert bízom benne!\n„A magasrendű itt úgy halad, hogy először összezavarodik, s aztán beteljesedik.”\nAz odaadás ennek a jósjelnek a lényege.\nAz érlelődést a tudásnál sokkal mélyebb, titokzatosabb, ösztönösebb, elemibb folyamatok vezetik. Nem érted, mi történik, s ez bizonytalanná tesz.\nA végén azonban megtudod, amit nem tudtál: mert megszülöd.\nAz egész folyamatot akkor rontod el, ha arról, amit nem tudsz, azt képzeled, hogy tudod.\nHa tudatlanságodat tudásnak véled, s elkezded magadat vezetni.\nValamennyien ezt tesszük.\n\nHit és szorgalom és várakozás helyett „kezünkbe vesszük a sorsunkat” - és elrontjuk.\nHa visszanézek, döbbenten látom, hogy önfejűségem miatt mennyi szellemi segítséget, jó szándékot, lehetőséget, üdvös eredményt rontottam el, csupán azzal, hogy az érlelődés láthatatlan folyamatába türelmetlenül beleavatkoztam.\n\n„Sorspánik”-nak neveztem azt az érzést, ami örökösen szétrombolta bennem az üdvös eredménye-ket. Amikor csak várni, hinni, tűrni és munkálkodni kellett volna, úgy éreztem, hogy nem történik semmi! Nekem kell kezembe vennem az életemet!...\n\nKiragadtam az életemet Isten kezéből, s az én kezemben a legrosszabb kézbe került - mint amikor a hívóból túlságosan hamar kikapjuk a fotópapírt: nem volt rajta kép, tönkrement.\nEz ennek a jósjelnek a legnagyobb veszélye: mestert játszani tanítvány helyett; erőszakkal, ostoba, túlzott akarattal, álokossággal, álférfiassággal átvenni a hatalmat ott, ahol az alázat lenne üdvös, a kivárás és a csöndes munkálkodás.\n\nA Kun jósjelnek - ha jól éljük meg - értékes a termése.\nItt tanulunk meg figyelni másokra, befogadni, megérteni sokféle embert - jókat és rosszakat egy-aránt. „A nemes lelkű tágas lénye hordozza az összes lényeket.”\nCsuang-ce mondta: „A dolgok élete olyan, mint a vágtató ló: nincs mozdulat, amely ne hozna válto-zást, s nincs olyan pillanat, amelyben át ne alakulnának. Hogy mit kell tenned? Hagyd mindig, hogy minden magától alakuljon!”\nEz a Befogadó titka.\n\nVonások\n\n1. Dérre lép, jön kemény jég.\nA „dér” még csak kétely - a kemény jég már konok hitetlenség: Kétely az, amit a fenti Csuang-ce idézet olvasásakor érzel: „Hagyni, hogy minden magától alakuljon? Nem lesz ebből baj? Nem kéne kezembe venni sorsom irányítását?”\nEzekből az átsurranó, bizalmatlan gondolatokból születik a baj. Csípd el őket korán, mert ha a gon-dolat valósággá „fagy”, már késő lesz. Maradj hűséges „kanca”! Kövesd a szívedet - ne az eszedet.\n\n2. Minden oldala egyenes és nagy. Nem gyakorol, s mégis mindent beteljesít.\nJól alakulnak a dolgok - maguktól. A Teremtő szimbóluma a Kör - a Befogadóé a Négyzet: ezt jel-képezi a kerek kínai pénzérmék közepén a négyzet formájú lyuk.\nA kör négyszögesítése: az eszme valóra válása. Ez történik most. Magától, természetesen, önkénte-lenül. Nem az eveződ, a sodrás röpíti csónakodat. S a bizalmad, hogy jó felé sodródsz.\n\n3. Légy kitartó, s a rejtett szépség megnyilvánul! Ha király ügyét szolgálod, ne a győze-lemre törj, hanem a beteljesítésre!\nNe törődj a hiúságoddal! Felejtsd el, mit szólnak hozzád az emberek! Ne érdekeljen az elismerés! Királyt szolgálsz - nem közönséges embereket!\nEz Hamvas Béla vonása: nem sikerre tört, hanem „dicsőségre”. Az ő fogalmai szerint ez a mélyen belülről s felülről jövő elismerést jelenti. Ez minden jó anya vonása, aki gyermeket szült a világra.\nA valódi tett jutalma önmagában és Istennél van. „Emberektől dicsőséget nem veszek” - mondta Jé-zus. A hiúsággal nemcsak magamat, de emberi kapcsolataimat is összezavarom.\nMost csak dolgozni kell, „pontosan és szépen” - a jutalom a jövőben van.\n\n4. Bekötött zsák. Nincs hiba. Nincs dicséret.\nEgyelőre kerülj minden összeütközést. Kitöréshez (Jang) hiányzik az erőd, s a passzivitásod (Jin) még gyengeség. Se ne ütközz, se ne add föl - tégy úgy, mint a sündisznó.\n\n5. Sárga alsóköntös. Magasztos üdv.\nA „sárga” a föld s a „Közép” színe. Ezt most rejtve viseled.\nÉtékeidet nem mutatod, nem is tudnak róla. A szerencsés folyamatok is rejtve alakulnak. Ez így van jól. Légy továbbra is diszkrét és taktikus. Nem baj, ha nem értékelnek. Az eredmény érik.\n\n6. Sárkányok küzdenek a réten. Vérük fekete és sárga.\nHatalmi küzdelem, amelyben mindkét fél vesztes lesz. Az egó megelégeli a „második helyet”. Föllá-zad, élre akar törni, s felborul a rend. Ismerős helyzet: a legtöbb válóper, bukott forradalom és siker-telen lázadás képe.\nHarci művészetben ez azt jelenti, hogy a Kun jelében küzdő harcos félelemből vagy agresszivitásból föladja lágy harcmodorát: Jangot Janggal akar legyőzni, s leverik. A bokszolók ezt egyszerűen úgy mondják: „Ne állj le verekedni!”\n\n";
            //string[] lines = Regex.Split(input, @"(?<=\d)\.\s");
            input = input.Replace("\\n", "\n");
            string[] lines = Regex.Split(input, @"(?=\d)");
            foreach (string line in lines)
            {
                Console.WriteLine(line);
            }
        }
        [Test]
        public void ParseLinesHunEng()
        {
            string input = @"2. Kun-BEFOGADÓ\n(Képjel. Föld - és a „területnek”, a „térnek” a jele)\n\nHat Jin vonás (azaz két „Föld” kua, trigram) alkotja e jelet.\nA Kun a Föld, az Anya, a Földanya, a Természet.\nAz Ég a láthatatlan ideák helye. Itt még minden a „gondolom”, „akarom”, a „legyen!” állapotában van, az Idő negyedik dimenziójában - ahhoz, hogy mindez megvalósuljon, kell az anyaöl odaadása, az anyaméh türelmes formáló ereje, amelyben testté alakul a mag, formává a gondolat; kell hozzá a hűség ereje, az odaadás ereje, az alkalmazkodás ereje. Az Égihez kell a Földi!\n\nBárhová nézel a földön, a növényekben, fákban, hegyekben, sziklákban, kövekben, de még egy ma-rok földben is az Anya művét látod: ezt csinálta abból, amit az Égi Atya akart: megvalósította. Alak-ká, térré formálta.\n\nA jósjel ítélete éppoly „szerencsés”, mint az előzőé:\n„Befogadó (Kun): jüan, heng, li, csen - de mindezt egy kanca odaadó kitartásával éri el.”\nA ló a Föld szimbóluma.\nA csődör is!\nA „kanca” itt azért szerepel, mert ősi tapasztalat, hogy ha egy csődör megindul, az összes kanca kö-veti. És ami szintén lényeges: több terhet tud viselni, mint a csődör.\nA követés a jel lényege: „Ő informál, s én megteszem.” (Mint amikor vezetnek a táncban!)\nA Kun valóra váltja azt, amit a Csien akart.\nLétrehozza a bőséget, a szépséget; növel, táplál, megsokszoroz.\nHa elveszti alázatát, ha ő akar irányítani, a folyamat csődöt mond: A szépség eltorzul, az eredmé-nyek elvetélnek, bőség helyett rákos burjánzás indul.\nA Kun mérhetetlen ereje az odaadó követésben van.\nAbban, hogy a gondolatot valóra váltja.\nA karmester csak int - a hangot, a dallamot és magát a muzsikát a zenész hozza létre, azzal, hogy követi a néma akaratot.\nA Kun jósjele azt tanácsolja: ne menj a saját fejed után! Inkább az intuíciódra hallgass, mint az eszedre. Ne törj az élre! Ne akarj irányítani! Légy türelmes! Egyszerű. Szívós. Józan. Bízz az ihle-tedben!\n\nMinél odaadóbb vagy, annál eredményesebb. Kövesd a csillagodat.\nA teremtés nem a te dolgod - a létrehozás igen! A megvalósítás.\nFigyelj a kézzel fogható, „reális” folyamatokra! Vesd meg lábadat a földön!\n\nGondolatok\n\nAz „Örök női” a legmélyebb szimbólum.\nSajnos, ma nem értjük, mert a sötét korban a nemek méltósága és jellege reménytelenül összekevere-dett: nincsenek igazi nők, ahogy nincsenek igazi férfiak sem.\nIsten egy - de ha megnyilvánul: kettő.\nTeremtő és Befogadó. Valamennyien Teremtők-Befogadók vagyunk - nemünktől függetlenül. Ahogy ki- és belélegzünk, úgy van életünknek Teremtő és Befogadó fázisa is.\nKözösségi életünkben is hol az egyik, hol a másik szerepet játsszuk, függetlenül attól, hogy apák va-gyunk vagy anyák.\nHa imádkozunk, valamennyien Befogadók vagyunk - Jézus is az volt: mindenben követte az Atya akaratát.\nTanítványainak azonban Teremtője volt, mint minden igazi Mester.\n„Hím” és „női” szerepek és létfázisok folyamatosan váltakoznak.\nEnnek a jósjelnek a lényege, hogy valami olyasmit kell követnem, amiről nem tudom pontosan, hogy micsoda.\nNem értem.\nNem tudatosult még bennem.\nOda kell adnom magamat valaminek - nem azért, mert ismerem, hanem azért, mert bízom benne!\n„A magasrendű itt úgy halad, hogy először összezavarodik, s aztán beteljesedik.”\nAz odaadás ennek a jósjelnek a lényege.\nAz érlelődést a tudásnál sokkal mélyebb, titokzatosabb, ösztönösebb, elemibb folyamatok vezetik. Nem érted, mi történik, s ez bizonytalanná tesz.\nA végén azonban megtudod, amit nem tudtál: mert megszülöd.\nAz egész folyamatot akkor rontod el, ha arról, amit nem tudsz, azt képzeled, hogy tudod.\nHa tudatlanságodat tudásnak véled, s elkezded magadat vezetni.\nValamennyien ezt tesszük.\n\nHit és szorgalom és várakozás helyett „kezünkbe vesszük a sorsunkat” - és elrontjuk.\nHa visszanézek, döbbenten látom, hogy önfejűségem miatt mennyi szellemi segítséget, jó szándékot, lehetőséget, üdvös eredményt rontottam el, csupán azzal, hogy az érlelődés láthatatlan folyamatába türelmetlenül beleavatkoztam.\n\n„Sorspánik”-nak neveztem azt az érzést, ami örökösen szétrombolta bennem az üdvös eredménye-ket. Amikor csak várni, hinni, tűrni és munkálkodni kellett volna, úgy éreztem, hogy nem történik semmi! Nekem kell kezembe vennem az életemet!...\n\nKiragadtam az életemet Isten kezéből, s az én kezemben a legrosszabb kézbe került - mint amikor a hívóból túlságosan hamar kikapjuk a fotópapírt: nem volt rajta kép, tönkrement.\nEz ennek a jósjelnek a legnagyobb veszélye: mestert játszani tanítvány helyett; erőszakkal, ostoba, túlzott akarattal, álokossággal, álférfiassággal átvenni a hatalmat ott, ahol az alázat lenne üdvös, a kivárás és a csöndes munkálkodás.\n\nA Kun jósjelnek - ha jól éljük meg - értékes a termése.\nItt tanulunk meg figyelni másokra, befogadni, megérteni sokféle embert - jókat és rosszakat egy-aránt. „A nemes lelkű tágas lénye hordozza az összes lényeket.”\nCsuang-ce mondta: „A dolgok élete olyan, mint a vágtató ló: nincs mozdulat, amely ne hozna válto-zást, s nincs olyan pillanat, amelyben át ne alakulnának. Hogy mit kell tenned? Hagyd mindig, hogy minden magától alakuljon!”\nEz a Befogadó titka.\n\nVonások\n\n1. Dérre lép, jön kemény jég.\nA „dér” még csak kétely - a kemény jég már konok hitetlenség: Kétely az, amit a fenti Csuang-ce idézet olvasásakor érzel: „Hagyni, hogy minden magától alakuljon? Nem lesz ebből baj? Nem kéne kezembe venni sorsom irányítását?”\nEzekből az átsurranó, bizalmatlan gondolatokból születik a baj. Csípd el őket korán, mert ha a gon-dolat valósággá „fagy”, már késő lesz. Maradj hűséges „kanca”! Kövesd a szívedet - ne az eszedet.\n\n2. Minden oldala egyenes és nagy. Nem gyakorol, s mégis mindent beteljesít.\nJól alakulnak a dolgok - maguktól. A Teremtő szimbóluma a Kör - a Befogadóé a Négyzet: ezt jel-képezi a kerek kínai pénzérmék közepén a négyzet formájú lyuk.\nA kör négyszögesítése: az eszme valóra válása. Ez történik most. Magától, természetesen, önkénte-lenül. Nem az eveződ, a sodrás röpíti csónakodat. S a bizalmad, hogy jó felé sodródsz.\n\n3. Légy kitartó, s a rejtett szépség megnyilvánul! Ha király ügyét szolgálod, ne a győze-lemre törj, hanem a beteljesítésre!\nNe törődj a hiúságoddal! Felejtsd el, mit szólnak hozzád az emberek! Ne érdekeljen az elismerés! Királyt szolgálsz - nem közönséges embereket!\nEz Hamvas Béla vonása: nem sikerre tört, hanem „dicsőségre”. Az ő fogalmai szerint ez a mélyen belülről s felülről jövő elismerést jelenti. Ez minden jó anya vonása, aki gyermeket szült a világra.\nA valódi tett jutalma önmagában és Istennél van. „Emberektől dicsőséget nem veszek” - mondta Jé-zus. A hiúsággal nemcsak magamat, de emberi kapcsolataimat is összezavarom.\nMost csak dolgozni kell, „pontosan és szépen” - a jutalom a jövőben van.\n\n4. Bekötött zsák. Nincs hiba. Nincs dicséret.\nEgyelőre kerülj minden összeütközést. Kitöréshez (Jang) hiányzik az erőd, s a passzivitásod (Jin) még gyengeség. Se ne ütközz, se ne add föl - tégy úgy, mint a sündisznó.\n\n5. Sárga alsóköntös. Magasztos üdv.\nA „sárga” a föld s a „Közép” színe. Ezt most rejtve viseled.\nÉtékeidet nem mutatod, nem is tudnak róla. A szerencsés folyamatok is rejtve alakulnak. Ez így van jól. Légy továbbra is diszkrét és taktikus. Nem baj, ha nem értékelnek. Az eredmény érik.\n\n6. Sárkányok küzdenek a réten. Vérük fekete és sárga.\nHatalmi küzdelem, amelyben mindkét fél vesztes lesz. Az egó megelégeli a „második helyet”. Föllá-zad, élre akar törni, s felborul a rend. Ismerős helyzet: a legtöbb válóper, bukott forradalom és siker-telen lázadás képe.\nHarci művészetben ez azt jelenti, hogy a Kun jelében küzdő harcos félelemből vagy agresszivitásból föladja lágy harcmodorát: Jangot Janggal akar legyőzni, s leverik. A bokszolók ezt egyszerűen úgy mondják: „Ne állj le verekedni!”\n\n::: ::: 666 666 2 K'un (The Receptive)\nAction: Reflect\nHu Gua (hidden influence) 2 Receptive: Yield\nZong Gua (underlying cause) 1 Creative: Initiate\n\nReaction is how you defend the past against the future.\nTake rest; a field that has rested gives a bountiful crop. – Ovid\n\nReading at a Glance: K’un calls for a period of patience and reflection. Where you may have been reactive in the past, it is time to learn how to be responsive. Reaction is a defensive position to uphold the known while responsiveness is open to the unknown. K’un encourages you to yield to the way each day is a creative awakening. A sense of openness and the release of clinging to structure and form will be necessary to give birth to this energy. The difference between reaction and response is your ability to use your senses and not the memory mind while observing. Stand in the moment with a sense of openness to what is unfolding without defending the past. Connect with each sense: Are you listening? Are you seeing how life speaks to you? Remove preconceptions and judgment. All things change in time and a period of action, reflected by the underlying cause of the Creative must give way to its opposite: Reflection. Like winter it is time to turn within and reinvigorate your inner world in preparation for a spring time to come. Embodying an open field in any activity – you are called to put your needs aside to serve, open and reflect before acting. K’un’s power of success comes from within. Move into the world from the inside ~ out. The Receptive is the womb holding the energy of attraction by way of intention that requires the development of sincerity and patience.\n\nAnd in the night,\nthe moonlike a bow -\nplays the song\nof the sun.\n\n“The Receptive is in harmony with the boundless; it embraces everything and illuminates everything in its greatness.” K’un is composed of all Yin lines and coaches you to become more still, observant and less reactive. By 'not doing anything' you become a spectator to see how circumstances unfold to guide you.\n\nThe master said: “when closely related things do not harmonize, misfortune is the result.” Misfortune is simply how you fight against necessary change. Sometimes K'un can be a message about letting the past go and opening to something new. You may be too attached to what you believe you want, when Tao is bringing you what you need. Look around to see what life is saying to you right now. Pay more attention to your dreams to uncover the profound guidance that comes from within.\n\nWhen you cultivate a natural response to what unfolds, you react less and observe more. It is often in the things that you cannot change that you discover Tao's power to guide you the most.\n\nCircumstances urge you forward, although reaction is how you defend the past against the future. A natural response means that you respond to life without defending anything. \nWe may find it odd that mystics deny the reality of the outer world, yet more people deny the immense power and reality of their inner world. Like the time of autumn when all things turn back to be renewed, you are coached to turn inward to reinvigorate your inner garden.\n\nWhen you compose your inner world and control its gusts and storms, you will discover wellness and harmony in the outer world. Tao prods you forward, but misfortune is how “those who go against the Way are called unlucky.”\nIf you are searching for direction, you will find it through your dreams, intuition and inspiration. When these inner clues are measured against events, synchronicity will validate your pathway. Be still and have patience so that you may begin to cultivate your personal connection to what unfolds.\n\nThere are times to push forward and times to remain still, as you “move inward and outward according to fixed rhythms.” Stand in the moment and observe your reaction to what unfolds around you. When you stop reacting, you will find yourself simply doing, and you can move forward with a new sense of ease and power.\n\nUnchanging: The quiet perseverance of the mare = do not lead, but follow. Without changing lines it is important to be open and acquiesce to others. There is not a lot you can do to change the situation, but your patience and receptivity is all that is required. If you are open and truly interested in serving and not taking, you can make something out of the fertile valley. Like the Creative unchanging, there is potential but it may be blocked for now. The confusion is real and serves the purpose of unleashing a more realistic perspective. Like a deep ravine, emotion is stirring but there may be no way to actualize it. This can happen when a relationship hits an impasse. The feeling is there but it can’t be acted upon for some reason, at least not now. The energy that flows through the openings can suggest that what you think is happening is happening and you want to grasp your desire, but time is just passing by. Trust this time of flowing with something you have no control over. Without a true understanding of your motives, the question can be thrown back at you: “Have you considered where this action would lead? What purpose does your desire serve? Does what you want serve the other person’s interests too? Can you make a commitment and follow through?” Therefore, examine your motives to ensure that you can be receptive enough to proceed. You may be meeting the moment with a lot of plans that won’t have any effect on the outcome, so let them go. Just as the moon reflects the light of the sun, you may need to simply reflect another’s power and light rather than competing or defending something. It is okay to be vulnerable and to be the valley, or take the lowly position without feeling any sense of failure. Your perseverance will be recognized, and another may be opening to you because of your undying loyalty.\n\nLine 1 Treading on hoarfrost, surely turns to ice = each step solidifies your decision. Changes to (24) Return. It is important to follow your inner drummer but realize that some decisions cannot be undone. Once you take this step, there may be no going back. You may have to go against another’s wishes to take the path you feel is right for you. However, you may Return to face the consequences of your impulsiveness. Observe cycles in nature because if it looks like winter is coming, it probably is. You may have to contend with another’s coldness in response to your actions.\n\nLine 2 Straight through the unfamiliar = speak your heart, it is not a disadvantage. Changes to (7) The Army. Everything unfolds naturally because it feels right and others recognize the value in following your initiative. Your open and honest invitation comes from the heart and is straight to the point. Any illusions or misconceptions are clarified. The situation has elements that you haven’t dealt with before but being truthful can help gain allegiance to your cause. Move forward like a soldier of the heart, unafraid of what you encounter.\n\nLine 3 Keeping the story to yourself = relying on another’s completion of matters. Changes to (15) Authenticity. Acting humbly and working hard allows you to complete the job. You may need to work quietly for the benefit of another without seeking credit. Or, you may need to allow another to complete something prior to moving forward. Eventually success is ensured because you put quality work and integrity above your need for recognition. Authenticity can only develop through interdependency not dependency.\n\nLine 4 Enclosing in a sack = no improvement because one remains closed. Changes to (16) Enthusiasm. Awareness may be too narrow or being fearful, you miss out on the joy of discovery. You may be hesitant about entering a situation where you will gain benefit. There is no reason not to trust events and invitations. Your own attitude and outlook are diminishing the opportunity for joy and fulfillment. Open to the mystery of life without the need to classify the outcome.\n\nLine 5 A yellow lower garment = modest and ordinary so all goes well. Changes to (8) Uniting. Dreams and meditation allow you to tap into a higher sense of awareness. It may seem that ego is here to discover spirit, but witnessing life as spirit is just a shift in perception, an awakening that will connect you to the here and now. Ego understands time as limitation but spirit has a timeless and unbiased outlook. Union suggests two manifestations of one thing, like matter and energy, although nothing is separate. When in doubt about your nature, remember who you were as a child. What is unchanging about you? Be that.Find a way to give it expression to your field of dreams.\n\nLine 6 Dragons fight in the field, their blood is old = fighting for a long time in an incapacitating situation. Changes to (23) Split Apart. The difference between having a response and having a reaction is the ability to listen and not defend your beliefs. Sometimes people defend each other’s differences rather than identify their similarities. The opportunity for renewal in the situation requires a blending of opposite qualities into a higher order. The symbol of 3 in dreams is how an either/or outlook blends to allow for all possibilities. If you want to discover the other person’s value, learn to listen to them. However, there is a limit to what can be done in this situation because the negativity has festered for some time.\n\n\n";
            input = input.Replace("\\n", "\n");

            //string[] separators = { "\n|", "\n:" };
            //string[] parts = input.Split(separators, StringSplitOptions.RemoveEmptyEntries);

            // string[] parts = Regex.Split(input, @"(?=[|:])");
            //string[] parts = Regex.Split(input, @"(?<=\n[|:])");
            string[] parts = Regex.Split(input, @"(?=\n[|:])");
            foreach (string line in parts)
            {
                Console.WriteLine($"==>{line}");
            }
        }

    }
}